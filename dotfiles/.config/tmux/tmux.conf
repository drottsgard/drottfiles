# Set the terminal type tmux reports to programs running inside it.
# "tmux-256color" tells programs they have 256-color support and are
# running under tmux (so they can use tmux-specific capabilities).
set -g default-terminal "tmux-256color"

# Tell tmux that the *outer* terminal (xterm-256color, what your Mac
# SSH session advertises) supports 24-bit RGB color. Without this,
# tmux strips true-color sequences and falls back to 256 colors,
# which is why colors look worse inside tmux than outside.
set -sa terminal-overrides ",xterm-256color:RGB"

# Allow programs inside tmux to set the system clipboard via OSC 52
# escape sequences. Required for copying in lazygit, neovim, etc.
# to reach the macOS clipboard over SSH.
set -g set-clipboard on

# Allow programs to send escape sequences through tmux to the outer
# terminal. Required for OSC 52 clipboard commands from lazygit when
# using the tmux passthrough escape sequence (\ePtmux;...\e\\).
set -g allow-passthrough on

# Enable mouse support: click to select panes/windows, drag to resize
# panes, and scroll through history with the scroll wheel.
set -g mouse on

# Increase scrollback buffer from the default 2000 lines to 50000.
# Useful when reviewing long command output or logs.
set -g history-limit 50000

# Reduce the delay tmux waits after receiving an escape key before
# passing it through. The default (500ms) makes Esc feel sluggish in
# editors. 10ms is the value Neovim's :checkhealth recommends.
set -g escape-time 10

# Let tmux pass focus-gained/focus-lost events to programs inside it.
# Neovim uses these to trigger autocommands (e.g. auto-reload files
# that changed on disk when the terminal regains focus).
set -g focus-events on

# Refresh the status bar every 5 seconds (default is 15).
set -g status-interval 5

# Number windows starting at 1 instead of 0. This matches the
# keyboard layout (1 is the leftmost number key), so prefix+1
# switches to the first window rather than prefix+0.
set -g base-index 1

# Same as above but for panes within a window.
setw -g pane-base-index 1

# When a window is closed, automatically renumber the remaining
# windows so there are no gaps (e.g. 1,2,3 instead of 1,3,4).
set -g renumber-windows on

# Split panes with | and - instead of the defaults (% and ").
# The characters visually represent the split direction: | is
# vertical divider (side-by-side), - is horizontal divider (stacked).
# -c "#{pane_current_path}" opens the new pane in the same directory
# as the current pane, instead of defaulting to $HOME.
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Bind prefix+r to reload this config file and show a confirmation.
# Saves you from having to restart tmux after editing this file.
bind r source-file ~/.config/tmux/tmux.conf \; display "Config reloaded"

# Open opencode in a new window, inheriting the current pane's directory.
bind o new-window -c "#{pane_current_path}" "opencode; $SHELL"

# ── Tokyo Night theme ──────────────────────────────────────

# Pane borders
set -g pane-border-style "fg=#565f89"
set -g pane-active-border-style "fg=#7aa2f7"

# Status bar
set -g status-style "bg=#1a1b26,fg=#c0caf5"
set -g status-left "#[fg=#1a1b26,bg=#7aa2f7,bold] #S #[default] "
set -g status-right "#[fg=#545c7e] %H:%M "
set -g status-left-length 20
set -g status-right-length 50

# Window tabs
setw -g window-status-format "#[fg=#545c7e] #I:#W "
setw -g window-status-current-format "#[fg=#7aa2f7,bold] #I:#W "

# Message & command line
set -g message-style "bg=#1a1b26,fg=#e0af68"
set -g message-command-style "bg=#1a1b26,fg=#e0af68"

# Copy mode highlight
setw -g mode-style "bg=#364a82,fg=#c0caf5"
